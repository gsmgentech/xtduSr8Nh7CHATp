<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>ICI SCHOOLS</title>
  <link rel="stylesheet" href="css/P6PQ6N5H.css">
  <link rel="icon" href="icons/icon-192.png">
  <style>
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0; top: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.5);
      justify-content: center;
      align-items: center;
    }
    .modal-content {
      background: #fff;
      padding: 20px;
      border-radius: 12px;
      text-align: center;
      width: 80%;
      max-width: 300px;
    }
    .modal-buttons {
      margin-top: 15px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .modal-buttons button {
      padding: 10px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
    }
    .visit-btn { background: #4CAF50; color: #fff; }
    .add-btn { background: #2196F3; color: #fff; }
    .remove-btn { background: #ff9800; color: #fff; }
    .cancel-btn { background: #f44336; color: #fff; }
    .move-up-btn { background: #9c27b0; color: #fff; }
    .move-down-btn { background: #3f51b5; color: #fff; }
  </style>
</head>
<body>
  <div class="header">
    <img src="img/gentechserver.png">
  </div>
  <div class="container">
    <div class="group-section">
      <select class="group-select" id="groupSelect">
        <option value="">All Schools</option>
        <option value="Bulacan">Bulacan - Malolos</option>
        <option value="Rizal">Rizal - Antipolo</option>
        <option value="Laguna">Laguna - Santa Cruz</option>

        <option value="Manila">Manila</option>
        <option value="Quezon City">Quezon City</option>
        <option value="Caloocan">Caloocan</option>
        <option value="Pasig">Pasig</option>
        <option value="Makati">Makati</option>
        <option value="Taguig">Taguig</option>
        <option value="Parañaque">Parañaque</option>
        <option value="Pasay">Pasay</option>
        <option value="Las Piñas">Las Piñas</option>
        <option value="Muntinlupa">Muntinlupa</option>
        <option value="Valenzuela">Valenzuela</option>
        <option value="Marikina">Marikina</option>
        <option value="Navotas">Navotas</option>
        <option value="Malabon">Malabon</option>
        <option value="Mandaluyong">Mandaluyong</option>
        <option value="San Juan">San Juan</option>

        <option value="Vigan">Ilocos Sur - Vigan</option>
        <option value="Laoag">Ilocos Norte - Laoag</option>
        <option value="San Fernando City">La Union - San Fernando</option>
        <option value="Lingayen">Pangasinan - Lingayen</option>
        <option value="Tuguegarao">Cagayan - Tuguegarao</option>
        <option value="Bayombong">Nueva Vizcaya - Bayombong</option>
        <option value="Ilagan">Isabela - Ilagan</option>
        <option value="Baler">Aurora - Baler</option>
        <option value="Balanga">Bataan - Balanga</option>
        <option value="Malolos">Bulacan - Malolos</option>
        <option value="Tarlac City">Tarlac - Tarlac City</option>
        <option value="Cabanatuan">Nueva Ecija - Cabanatuan</option>
        <option value="Palayan City">Nueva Ecija (official) - Palayan</option>
        <option value="Iba">Zambales - Iba</option>
        <option value="Calapan">Oriental Mindoro - Calapan</option>
        <option value="Mamburao">Occidental Mindoro - Mamburao</option>
        <option value="Boac">Marinduque - Boac</option>
        <option value="Romblon">Romblon - Romblon</option>
        <option value="Puerto Princesa">Palawan - Puerto Princesa</option>
        <option value="Lucena">Quezon - Lucena</option>
        <option value="Santa Cruz">Laguna - Santa Cruz</option>
        <option value="Trece Martires">Cavite - Trece Martires</option>
        <option value="Batangas City">Batangas - Batangas City</option>
        <option value="Calapan">Mindoro Oriental - Calapan</option>
        <option value="Masbate City">Masbate - Masbate City</option>
        <option value="Legazpi">Albay - Legazpi</option>
        <option value="Sorsogon City">Sorsogon - Sorsogon City</option>
        <option value="Daet">Camarines Norte - Daet</option>
        <option value="Naga">Camarines Sur - Naga</option>
        <option value="Virac">Catanduanes - Virac</option>

        <option value="Iloilo City">Iloilo - Iloilo City</option>
        <option value="Roxas City">Capiz - Roxas City</option>
        <option value="Kalibo">Aklan - Kalibo</option>
        <option value="San Jose de Buenavista">Antique - San Jose de Buenavista</option>
        <option value="Jordan">Guimaras - Jordan</option>
        <option value="Bacolod">Negros Occidental - Bacolod</option>
        <option value="Dumaguete">Negros Oriental - Dumaguete</option>
        <option value="Tacloban">Leyte - Tacloban</option>
        <option value="Maasin">Southern Leyte - Maasin</option>
        <option value="Catbalogan">Samar - Catbalogan</option>
        <option value="Borongan">Eastern Samar - Borongan</option>
        <option value="Catarman">Northern Samar - Catarman</option>
        <option value="Naval">Biliran - Naval</option>
        <option value="Tagbilaran">Bohol - Tagbilaran</option>
        <option value="Cebu City">Cebu - Cebu City</option>
        <option value="Siquijor">Siquijor - Siquijor</option>
        <option value="Ormoc">Leyte (another major city) - Ormoc</option>

        <option value="Davao City">Davao del Sur - Davao City</option>
        <option value="Tagum">Davao del Norte - Tagum</option>
        <option value="Mati">Davao Oriental - Mati</option>
        <option value="Digos">Davao del Sur - Digos</option>
        <option value="Koronadal">South Cotabato - Koronadal</option>
        <option value="General Santos">General Santos City</option>
        <option value="Cotabato City">Maguindanao - Cotabato City</option>
        <option value="Kidapawan">North Cotabato - Kidapawan</option>
        <option value="Marawi">Lanao del Sur - Marawi</option>
        <option value="Iligan">Lanao del Norte - Iligan</option>
        <option value="Cagayan de Oro">Misamis Oriental - Cagayan de Oro</option>
        <option value="Oroquieta">Misamis Occidental - Oroquieta</option>
        <option value="Dipolog">Zamboanga del Norte - Dipolog</option>
        <option value="Pagadian">Zamboanga del Sur - Pagadian</option>
        <option value="Zamboanga City">Zamboanga City</option>
        <option value="Malaybalay">Bukidnon - Malaybalay</option>
        <option value="Valencia">Bukidnon - Valencia</option>
        <option value="Butuan">Agusan del Norte - Butuan</option>
        <option value="Prosperidad">Agusan del Sur - Prosperidad</option>
        <option value="Surigao City">Surigao del Norte - Surigao City</option>
        <option value="Tandag">Surigao del Sur - Tandag</option>
        <option value="Bislig">Surigao del Sur - Bislig</option>
        <option value="Isabela City">Basilan - Isabela City</option>
        <option value="Jolo">Sulu - Jolo</option>
        <option value="Bongao">Tawi-Tawi - Bongao</option>
      </select>
    </div>
    <div class="search-bar-section">
      <input type="text" class="search-bar" id="searchInput" placeholder="Search Schools">
    </div>
    <div class="pinned-schools" id="pinnedSchools">
      <div class="pinned-section-title">MY TRIP TODAY</div>
      <div class="trip-count" id="tripCount">Trip Count: 0</div>
      <button class="reset-button" onclick="resetPinnedSchools()">CLEAR ALL</button>
    </div>
    <div class="section-title">ALL SCHOOLS</div>

    <div class="school">
      <div class="school-name">COLEGIO DE SAN BARACHIEL</div>
      <div class="coordenates-school-location-wrapper">
        <div class="coordenates">15.0715771, 120.9211509</div>
        <span class="school-location">San Ildefonso Bulacan</span>
      </div>
    </div>

    <div class="school">
      <div class="school-name">GLORIOUS JOY KIDDIE</div>
      <div class="coordenates-school-location-wrapper">
        <div class="coordenates">15.001889, 120.930827</div>
        <span class="school-location">San Rafael Bulacan</span>
      </div>
    </div>

    <div class="school">
      <div class="school-name">SECOND HOME CHILD DEV. CENTER</div>
      <div class="coordenates-school-location-wrapper">
        <div class="coordenates">14.9668677, 120.9140015</div>
        <span class="school-location">Baliwag Bulacan</span>
      </div>
    </div>

    <div class="school">
      <div class="school-name">SUNBEAM KIDDIE CENTER</div>
      <div class="coordenates-school-location-wrapper">
        <div class="coordenates">14.8411586, 120.8378956</div>
        <span class="school-location">Malolos Bulacan</span>
      </div>
    </div>

    <div class="school">
      <div class="school-name">STEWART CHRISTIAN SCHOOL</div>
      <div class="coordenates-school-location-wrapper">
        <div class="coordenates">14.8479122, 121.0512458</div>
        <span class="school-location">SJDM Bulacan</span>
      </div>
    </div>
  </div>

  <div class="modal" id="actionModal">
    <div class="modal-content">
      <div id="modalSchoolName"></div>
      <div id="modalMessage" style="margin-top:10px;color:#555;font-size:14px;"></div>
      <div class="modal-buttons" id="modalButtons"></div>
    </div>
  </div>

  <script>
    const modal = document.getElementById('actionModal');
    const modalSchoolName = document.getElementById('modalSchoolName');
    const modalMessage = document.getElementById('modalMessage');
    const modalButtons = document.getElementById('modalButtons');
    const pinnedContainer = document.getElementById('pinnedSchools');
    const tripCount = document.getElementById('tripCount');
    let selectedSchool = null;

    window.onload = () => {
      const saved = JSON.parse(localStorage.getItem("pinnedSchools") || "[]");
      saved.forEach(html => {
        const wrapper = document.createElement('div');
        wrapper.innerHTML = html;
        const school = wrapper.firstElementChild;
        attachSchoolEvents(school, true);
        pinnedContainer.appendChild(school);
      });
      updateTripCount();
    };

    function attachSchoolEvents(school, isPinned = false) {
      school.addEventListener('click', () => {
        const name = school.querySelector('.school-name').textContent;
        const coords = school.querySelector('.coordenates').textContent;
        selectedSchool = { element: school, name, coords, isPinned };
        showModal(name, isPinned);
      });
    }

    document.querySelectorAll('.school').forEach(s => attachSchoolEvents(s));

    function showModal(name, isPinned) {
      modalSchoolName.textContent = name;
      modalMessage.textContent = "";
      modalButtons.innerHTML = "";

      const visitBtn = document.createElement("button");
      visitBtn.textContent = "Visit";
      visitBtn.className = "visit-btn";
      visitBtn.onclick = () => {
        window.open(`https://www.google.com/maps?q=${selectedSchool.coords}`, "_blank");
        closeModal();
      };
      modalButtons.appendChild(visitBtn);

      if (isPinned) {
        const moveUpBtn = document.createElement("button");
        moveUpBtn.textContent = "↑ Move Up";
        moveUpBtn.className = "move-up-btn";
        moveUpBtn.onclick = () => {
          const prev = selectedSchool.element.previousElementSibling;
          if (prev && prev.classList.contains('school')) {
            pinnedContainer.insertBefore(selectedSchool.element, prev);
            savePinnedSchools();
          }
          closeModal();
        };
        modalButtons.appendChild(moveUpBtn);

        const removeBtn = document.createElement("button");
        removeBtn.textContent = "Remove";
        removeBtn.className = "remove-btn";
        removeBtn.onclick = () => {
          selectedSchool.element.remove();
          savePinnedSchools();
          updateTripCount();
          closeModal();
        };
        modalButtons.appendChild(removeBtn);

        const moveDownBtn = document.createElement("button");
        moveDownBtn.textContent = "↓ Move Down";
        moveDownBtn.className = "move-down-btn";
        moveDownBtn.onclick = () => {
          const next = selectedSchool.element.nextElementSibling;
          if (next) {
            pinnedContainer.insertBefore(next, selectedSchool.element);
            savePinnedSchools();
          }
          closeModal();
        };
        modalButtons.appendChild(moveDownBtn);

      } else {
        const alreadyPinned = [...pinnedContainer.querySelectorAll('.school')].some(
          s => s.querySelector('.school-name').textContent === name
        );
        if (alreadyPinned) {
          modalMessage.textContent = "You already added this school.";
        } else {
          const addBtn = document.createElement("button");
          addBtn.textContent = "Add";
          addBtn.className = "add-btn";
          addBtn.onclick = () => {
            const clone = selectedSchool.element.cloneNode(true);
            attachSchoolEvents(clone, true);
            pinnedContainer.appendChild(clone);
            savePinnedSchools();
            updateTripCount();
            closeModal();
          };
          modalButtons.appendChild(addBtn);
        }
      }

      const cancelBtn = document.createElement("button");
      cancelBtn.textContent = "Cancel";
      cancelBtn.className = "cancel-btn";
      cancelBtn.onclick = closeModal;
      modalButtons.appendChild(cancelBtn);

      modal.style.display = "flex";
    }

    function closeModal() {
      modal.style.display = "none";
    }

    function savePinnedSchools() {
      const pinned = [...pinnedContainer.querySelectorAll('.school')];
      const data = pinned.map(s => s.outerHTML);
      localStorage.setItem("pinnedSchools", JSON.stringify(data));
    }

    function updateTripCount() {
      const count = pinnedContainer.querySelectorAll('.school').length;
      tripCount.textContent = "Trip Count: " + count;
    }

    function resetPinnedSchools() {
      pinnedContainer.querySelectorAll('.school').forEach(e => e.remove());
      savePinnedSchools();
      updateTripCount();
    }
  </script>
</body>
</html>
