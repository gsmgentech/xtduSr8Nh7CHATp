<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>ICI SCHOOLS</title>
  <link rel="stylesheet" href="css/P6PQ6N5H.css">
  <link rel="icon" href="icons/icon-192.png">
  <style>
  </style>
</head>
<body>
  <div class="header">
    <img src="img/gentechserver.png">
  </div>
  <div class="container">
        <div class="group-section">
      <select class="group-select" id="groupSelect">
        <option value="">All Schools</option>
        <option value="Bulacan">Bulacan - Malolos</option>
        <option value="Rizal">Rizal - Antipolo</option>
        <option value="Laguna">Laguna - Santa Cruz</option>

        <option value="Manila">Manila</option>
        <option value="Quezon City">Quezon City</option>
        <option value="Caloocan">Caloocan</option>
        <option value="Pasig">Pasig</option>
        <option value="Makati">Makati</option>
        <option value="Taguig">Taguig</option>
        <option value="Parañaque">Parañaque</option>
        <option value="Pasay">Pasay</option>
        <option value="Las Piñas">Las Piñas</option>
        <option value="Muntinlupa">Muntinlupa</option>
        <option value="Valenzuela">Valenzuela</option>
        <option value="Marikina">Marikina</option>
        <option value="Navotas">Navotas</option>
        <option value="Malabon">Malabon</option>
        <option value="Mandaluyong">Mandaluyong</option>
        <option value="San Juan">San Juan</option>

        <option value="Vigan">Ilocos Sur - Vigan</option>
        <option value="Laoag">Ilocos Norte - Laoag</option>
        <option value="San Fernando City">La Union - San Fernando</option>
        <option value="Lingayen">Pangasinan - Lingayen</option>
        <option value="Tuguegarao">Cagayan - Tuguegarao</option>
        <option value="Bayombong">Nueva Vizcaya - Bayombong</option>
        <option value="Ilagan">Isabela - Ilagan</option>
        <option value="Baler">Aurora - Baler</option>
        <option value="Balanga">Bataan - Balanga</option>
        <option value="Malolos">Bulacan - Malolos</option>
        <option value="Tarlac City">Tarlac - Tarlac City</option>
        <option value="Cabanatuan">Nueva Ecija - Cabanatuan</option>
        <option value="Palayan City">Nueva Ecija (official) - Palayan</option>
        <option value="Iba">Zambales - Iba</option>
        <option value="Calapan">Oriental Mindoro - Calapan</option>
        <option value="Mamburao">Occidental Mindoro - Mamburao</option>
        <option value="Boac">Marinduque - Boac</option>
        <option value="Romblon">Romblon - Romblon</option>
        <option value="Puerto Princesa">Palawan - Puerto Princesa</option>
        <option value="Lucena">Quezon - Lucena</option>
        <option value="Santa Cruz">Laguna - Santa Cruz</option>
        <option value="Trece Martires">Cavite - Trece Martires</option>
        <option value="Batangas City">Batangas - Batangas City</option>
        <option value="Calapan">Mindoro Oriental - Calapan</option>
        <option value="Masbate City">Masbate - Masbate City</option>
        <option value="Legazpi">Albay - Legazpi</option>
        <option value="Sorsogon City">Sorsogon - Sorsogon City</option>
        <option value="Daet">Camarines Norte - Daet</option>
        <option value="Naga">Camarines Sur - Naga</option>
        <option value="Virac">Catanduanes - Virac</option>

        <option value="Iloilo City">Iloilo - Iloilo City</option>
        <option value="Roxas City">Capiz - Roxas City</option>
        <option value="Kalibo">Aklan - Kalibo</option>
        <option value="San Jose de Buenavista">Antique - San Jose de Buenavista</option>
        <option value="Jordan">Guimaras - Jordan</option>
        <option value="Bacolod">Negros Occidental - Bacolod</option>
        <option value="Dumaguete">Negros Oriental - Dumaguete</option>
        <option value="Tacloban">Leyte - Tacloban</option>
        <option value="Maasin">Southern Leyte - Maasin</option>
        <option value="Catbalogan">Samar - Catbalogan</option>
        <option value="Borongan">Eastern Samar - Borongan</option>
        <option value="Catarman">Northern Samar - Catarman</option>
        <option value="Naval">Biliran - Naval</option>
        <option value="Tagbilaran">Bohol - Tagbilaran</option>
        <option value="Cebu City">Cebu - Cebu City</option>
        <option value="Siquijor">Siquijor - Siquijor</option>
        <option value="Ormoc">Leyte (another major city) - Ormoc</option>

        <option value="Davao City">Davao del Sur - Davao City</option>
        <option value="Tagum">Davao del Norte - Tagum</option>
        <option value="Mati">Davao Oriental - Mati</option>
        <option value="Digos">Davao del Sur - Digos</option>
        <option value="Koronadal">South Cotabato - Koronadal</option>
        <option value="General Santos">General Santos City</option>
        <option value="Cotabato City">Maguindanao - Cotabato City</option>
        <option value="Kidapawan">North Cotabato - Kidapawan</option>
        <option value="Marawi">Lanao del Sur - Marawi</option>
        <option value="Iligan">Lanao del Norte - Iligan</option>
        <option value="Cagayan de Oro">Misamis Oriental - Cagayan de Oro</option>
        <option value="Oroquieta">Misamis Occidental - Oroquieta</option>
        <option value="Dipolog">Zamboanga del Norte - Dipolog</option>
        <option value="Pagadian">Zamboanga del Sur - Pagadian</option>
        <option value="Zamboanga City">Zamboanga City</option>
        <option value="Malaybalay">Bukidnon - Malaybalay</option>
        <option value="Valencia">Bukidnon - Valencia</option>
        <option value="Butuan">Agusan del Norte - Butuan</option>
        <option value="Prosperidad">Agusan del Sur - Prosperidad</option>
        <option value="Surigao City">Surigao del Norte - Surigao City</option>
        <option value="Tandag">Surigao del Sur - Tandag</option>
        <option value="Bislig">Surigao del Sur - Bislig</option>
        <option value="Isabela City">Basilan - Isabela City</option>
        <option value="Jolo">Sulu - Jolo</option>
        <option value="Bongao">Tawi-Tawi - Bongao</option>
      </select>
    </div>
    <div class="search-bar-section">
      <input type="text" class="search-bar" id="searchInput" placeholder="Search Schools">
    </div>
    <div class="pinned-schools" id="pinnedSchools">
      <div class="pinned-section-title">MY TRIP TODAY</div>
      <div class="trip-count" id="tripCount">Trip Count: 0</div>
      <button class="reset-button" onclick="resetPinnedSchools()">CLEAR ALL</button>
    </div>

    <div class="section-title">ALL SCHOOLS</div>
    <!--div class="school">
      <div class="school-name">XXXX</div>
      <div class="coordenates-school-location-wrapper">
        <div class="school-address">XXX</div>
        <div class="coordenates">XXX</div>
        <span class="school-location">XXX</span>
      </div>
    </div>

    <div class="school">
      <div class="school-name">XXXX</div>
      <div class="coordenates-school-location-wrapper">
        <div class="school-address">XXX</div>
        <div class="coordenates">XXX</div>
        <span class="school-location">XXX</span>
      </div>
    </div-->

    <div class="school">
      <div class="school-name">PENABLANCA UNITED METHODIST CHURCH</div>
      <div class="coordenates-school-location-wrapper">
        <div class="school-address">PENABLANCA, CAGAYAN VALLEY</div>
        <div class="coordenates">17.624861838981047, 121.78576359340347</div>
        <span class="school-location">CAGAYAN</span>
      </div>
    </div>

    <div class="school">
      <div class="school-name">CHRISTIAN BAPTIST ACADEMY</div>
      <div class="coordenates-school-location-wrapper">
        <div class="school-address">CAGAYAN VALLEY RD, TUGUEGARAO CITY</div>
        <div class="coordenates">17.651321061890876, 121.74229111705904</div>
        <span class="school-location">CAGAYAN</span>
      </div>
    </div>

    <div class="school">
      <div class="school-name">SAINT CLARE MONTESSORI SCHOOL OF TUGUEGARAO INC.</div>
      <div class="coordenates-school-location-wrapper">
        <div class="school-address">BAGAY RD, TUGUEGARAO CITY</div>
        <div class="coordenates">17.622070580952766, 121.72344890039895</div>
        <span class="school-location">CAGAYAN</span>
      </div>
    </div>

    <div class="school">
      <div class="school-name">METHODIST CHRISTIAN SCHOOL</div>
      <div class="coordenates-school-location-wrapper">
        <div class="school-address">DEL ROSARIO ST, TUGUEGARAO CITY</div>
        <div class="coordenates">17.61735642068248, 121.72735125577674</div>
        <span class="school-location">CAGAYAN</span>
      </div>
    </div>
    
    <div class="school">
      <div class="school-name">JOLLY LEARNING SCHOOL</div>
      <div class="coordenates-school-location-wrapper">
        <div class="school-address">LECAROS ST, TUGUEGARAO CITY</div>
        <div class="coordenates">17.611149958284052, 121.71923319129344</div>
        <span class="school-location">CAGAYAN</span>
      </div>
    </div>

    <div class="school">
      <div class="school-name">APAYAO STATE COLLEGE</div>
      <div class="coordenates-school-location-wrapper">
        <div class="school-address">CONNER, PINUKPUK RD,</div>
        <div class="coordenates">17.80875993050121, 121.29462490903545</div>
        <span class="school-location">APAYAO</span>
      </div>
    </div>

    <div class="school">
      <div class="school-name">UNITED CHURCH OF CHRIST IN THE PHILIPPINES</div>
      <div class="coordenates-school-location-wrapper">
        <div class="school-address">CONNER, KABUGAO RD</div>
        <div class="coordenates">17.836962789140305, 121.25841677098585</div>
        <span class="school-location">APAYAO</span>
      </div>
    </div>

    <div class="school">
      <div class="school-name">GONZAGA BIBLE BAPTIST ACADEMY</div>
      <div class="coordenates-school-location-wrapper">
        <div class="school-address">GONZAGA</div>
        <div class="coordenates">18.263034702178647, 121.99044834226267</div>
        <span class="school-location">CAGAYAN</span>
      </div>
    </div>

    <div class="school">
      <div class="school-name">BUGUEY CHRISTIAN SCHOOL FOR LIFE</div>
      <div class="coordenates-school-location-wrapper">
        <div class="school-address">BUGUEY, CAGAYAN</div>
        <div class="coordenates">18.28791410195949, 121.83421907418578</div>
        <span class="school-location">CAGAYAN</span>
      </div>
    </div>

    <div class="school">
      <div class="school-name">LALLO CHRISTIAN ACADEMY</div>
      <div class="coordenates-school-location-wrapper">
        <div class="school-address">LAL-LO</div>
        <div class="coordenates">18.184115663734726, 121.66118058960834</div>
        <span class="school-location">CAGAYAN</span>
      </div>
    </div>

    <div class="school">
      <div class="school-name">APARRI KIDDIE COLLEGE</div>
      <div class="coordenates-school-location-wrapper">
        <div class="school-address">MAGSAYSAY ST, APARRI</div>
        <div class="coordenates">18.35592031420172, 121.63860909675154</div>
        <span class="school-location">CAGAYAN</span>
      </div>
    </div>

    <div class="school">
      <div class="school-name">BUKIG UNITED METHODIST CHURCH</div>
      <div class="coordenates-school-location-wrapper">
        <div class="school-address">MANILA N RD, APARRI</div>
        <div class="coordenates">18.309654074484023, 121.61145143524222</div>
        <span class="school-location">CAGAYAN</span>
      </div>
    </div>

    <div class="school">
      <div class="school-name">LUNA NATIONAL HIGH SCHOOL</div>
      <div class="coordenates-school-location-wrapper">
        <div class="school-address">LUNA, CORDILLERA</div>
        <div class="coordenates">18.33306678790725, 121.35761796062502</div>
        <span class="school-location">APAYAO</span>
      </div>
    </div>

    <div class="school">
      <div class="school-name">LUNA CENTRAL SCHOOL</div>
      <div class="coordenates-school-location-wrapper">
        <div class="school-address">LUNA, CORDILLERA</div>
        <div class="coordenates">18.3332585766984, 121.35689840707424</div>
        <span class="school-location">APAYAO</span>
      </div>
    </div>

    <div class="school">
      <div class="school-name">JESUS THE KING OF GLORY DOOR OF FAITH CHURCH INC.</div>
      <div class="coordenates-school-location-wrapper">
        <div class="school-address">DE AGOSTO ST, MALOLOS</div>
        <div class="coordenates">14.849725155789038, 120.80561581595587</div>
        <span class="school-location">BULACAN</span>
      </div>
    </div>

    <div class="school">
      <div class="school-name">BULACAN ECUMENICAL SCHOOL</div>
      <div class="coordenates-school-location-wrapper">
        <div class="school-address">LIANG, MALOLOS</div>
        <div class="coordenates">14.848403277624143, 120.81451109614216</div>
        <span class="school-location">BULACAN</span>
      </div>
    </div>

    <div class="school">
      <div class="school-name">CENTRO ESCOLAR INTEGRATED SCHOOL</div>
      <div class="coordenates-school-location-wrapper">
        <div class="school-address">MACARTHUR HWY, MALOLOS</div>
        <div class="coordenates">14.870209778780978, 120.80049789018535</div>
        <span class="school-location">BULACAN</span>
      </div>
    </div>

    <div class="school">
      <div class="school-name">THE CLARION SCHOOL</div>
      <div class="coordenates-school-location-wrapper">
        <div class="school-address">ESTRELLA ST, MALOLOS</div>
        <div class="coordenates">14.840327750886773, 120.81222385556168</div>
        <span class="school-location">BULACAN</span>
      </div>
    </div>

    <div class="school">
      <div class="school-name">PRECIOUS VESSELS CHRISTIAN ACADEMY</div>
      <div class="coordenates-school-location-wrapper">
        <div class="school-address">PALIWAS RD, OBANDO</div>
        <div class="coordenates">14.716032728983244, 120.93247976525863</div>
        <span class="school-location">BULACAN</span>
      </div>
    </div>

    <div class="school">
      <div class="school-name">HOLY TRINITY SCHOOL OF OBANDO INC.</div>
      <div class="coordenates-school-location-wrapper">
        <div class="school-address">KABESANG IMO ST, LAWA OBANDO</div>
        <div class="coordenates">14.725752055722705, 120.93046800908199</div>
        <span class="school-location">BULACAN</span>
      </div>
    </div>

    <div class="school">
      <div class="school-name">BARCELONA ACADEMY</div>
      <div class="coordenates-school-location-wrapper">
        <div class="school-address">GABRIEL ST, MARILAO</div>
        <div class="coordenates">14.760454, 120.965846</div>
        <span class="school-location">BULACAN</span>
      </div>
    </div>

    <div class="school">
      <div class="school-name">HOLY LAMB ACADEMY INC</div>
      <div class="coordenates-school-location-wrapper">
        <div class="school-address">PATUBIG RD, MARILAO</div>
        <div class="coordenates">14.781953201556556, 120.96151654813173</div>
        <span class="school-location">BULACAN</span>
      </div>
    </div>

    <div class="school">
      <div class="school-name">GOOD SHEPHERD MONTESSORI SCHOOL OF MARILAO</div>
      <div class="coordenates-school-location-wrapper">
        <div class="school-address">R. CUTODIO ST, MARILAO</div>
        <div class="coordenates">14.763664438487867, 120.95597450415404</div>
        <span class="school-location">BULACAN</span>
      </div>
    </div>

    <div class="school">
      <div class="school-name" style="color: rgb(219, 20, 20);">FRIENDS OF JESUS CHRISTIAN SCHOOL INCORPORATED</div>
      <div class="coordenates-school-location-wrapper">
        <div class="school-address">TAAL, BOCAUE</div>
        <div class="coordenates">14.804856439550708, 120.9249753181722</div>
        <span class="school-location">BULACAN</span>
      </div>
    </div>

    <div class="school">
      <div class="school-name">MALOLOS CHRISTIAN SCHOOL</div>
      <div class="coordenates-school-location-wrapper">
        <div class="school-address">STO. CRISTO, MALOLOS</div>
        <div class="coordenates">14.830778483162302, 120.82004619131625</div>
        <span class="school-location">BULACAN</span>
      </div>
    </div>

    <div class="school">
      <div class="school-name">SMART CHILD MULTIPLE INTELLIGENCE ACADEMY INC.</div>
      <div class="coordenates-school-location-wrapper">
        <div class="school-address">KRUS ST, BULAKAN</div>
        <div class="coordenates">14.813084024448836, 120.8845178532014</div>
        <span class="school-location">BULACAN</span>
      </div>
    </div>

    <div class="school">
      <div class="school-name">ST. ANTHONY ACADEMY OF BULACAN</div>
      <div class="coordenates-school-location-wrapper">
        <div class="school-address">STA. ANA, BULAKAN</div>
        <div class="coordenates">14.794282552879721, 120.87990469009098</div>
        <span class="school-location">BULACAN</span>
      </div>
    </div>

    <div class="school">
      <div class="school-name">DR. LITAO LEARNING SCHOOL, INC.</div>
      <div class="coordenates-school-location-wrapper">
        <div class="school-address">STA. ANA, BULAKAN</div>
        <div class="coordenates">14.79390955783285, 120.88024347528643</div>
        <span class="school-location">BULACAN</span>
      </div>
    </div>

    <div class="school">
      <div class="school-name">ASSUMPTA ACADEMY, BULACAN, INC.</div>
      <div class="coordenates-school-location-wrapper">
        <div class="school-address">CAMINO REAL ST, SAN JOSE BULAKAN</div>
        <div class="coordenates">14.794258568984427, 120.87990766331585</div>
        <span class="school-location">BULACAN</span>
      </div>
    </div>

    <div class="school">
      <div class="school-name">DUNAMIS CHRISTIAN LEARNING CENTER</div>
      <div class="coordenates-school-location-wrapper">
        <div class="school-address">AGOHO ST, MARILAO</div>
        <div class="coordenates">14.769928690757768, 120.93639980406377</div>
        <span class="school-location">BULACAN</span>
      </div>
    </div>

    <div class="school">
      <div class="school-name">COLEGIO DE SAN BARACHIEL</div>
      <div class="coordenates-school-location-wrapper">
        <div class="school-address">PUROK 1 CALAWITAN, SAN ILDEFONSO</div>
        <div class="coordenates">15.0715771, 120.9211509</div>
        <span class="school-location">BULACAN</span>
      </div>
    </div>

    <div class="school">
      <div class="school-name">GLORIOUS JOY KIDDIE</div>
      <div class="coordenates-school-location-wrapper">
        <div class="school-address">DR GUIZANO, SAN RAFAEL</div>
        <div class="coordenates">15.001889, 120.930827</div>
        <span class="school-location">BULACAN</span>
      </div>
    </div>

    <div class="school">
      <div class="school-name">SECOND HOME CHILD DEV. CENTER</div>
      <div class="coordenates-school-location-wrapper">
        <div class="school-address">A. MABINI ST, BALIWAG</div>
        <div class="coordenates">14.9668677, 120.9140015</div>
        <span class="school-location">BULACAN</span>
      </div>
    </div>

    <div class="school">
      <div class="school-name">SUNBEAM KIDDIE CENTER</div>
      <div class="coordenates-school-location-wrapper">
        <div class="school-address">BAGONG BAYAN, SCHOOL ROAD, MALOLOS</div>
        <div class="coordenates">14.8411586, 120.8378956</div>
        <span class="school-location">BULACAN</span>
      </div>
    </div>

    <div class="school">
      <div class="school-name">STEWART CHRISTIAN SCHOOL</div>
      <div class="coordenates-school-location-wrapper">
        <div class="school-address">ASUNCION, SJDM</div>
        <div class="coordenates">14.8479122, 121.0512458</div>
        <span class="school-location">BULACAN</span>
      </div>
    </div>
  </div>

  <div class="modal" id="actionModal">
    <div class="modal-content">
      <div id="modalSchoolName"></div>
      <div id="modalMessage" style="margin-top:10px;font-size:14px;"></div>
      <div class="modal-buttons" id="modalButtons"></div>
    </div>
  </div>

  <script>
    const modal = document.getElementById('actionModal');
    const modalSchoolName = document.getElementById('modalSchoolName');
    const modalMessage = document.getElementById('modalMessage');
    const modalButtons = document.getElementById('modalButtons');
    const pinnedContainer = document.getElementById('pinnedSchools');
    const tripCount = document.getElementById('tripCount');
    const searchInput = document.getElementById('searchInput');
    let selectedSchool = null;

    window.onload = () => {
      const saved = JSON.parse(localStorage.getItem("pinnedSchools") || "[]");
      saved.forEach(html => {
        const wrapper = document.createElement('div');
        wrapper.innerHTML = html;
        const school = wrapper.firstElementChild;
        attachSchoolEvents(school, true);
        const clearBtn = pinnedContainer.querySelector(".reset-button");
        pinnedContainer.insertBefore(school, clearBtn);
      });
      updateTripCount();
    };

    function attachSchoolEvents(school, isPinned = false) {
      school.addEventListener('click', () => {
        const name = school.querySelector('.school-name').textContent;
        const coords = school.querySelector('.coordenates').textContent;
        selectedSchool = { element: school, name, coords, isPinned };
        showModal(name, isPinned);
      });
    }

    document.querySelectorAll('.school').forEach(s => attachSchoolEvents(s));

    function showModal(name, isPinned) {
      modalSchoolName.textContent = name;
      modalMessage.textContent = "";
      modalMessage.classList.remove("warning");
      modalButtons.innerHTML = "";

      const visitBtn = document.createElement("button");
      visitBtn.textContent = "Visit";
      visitBtn.className = "visit-btn";
      visitBtn.onclick = () => {
        window.open(`https://www.google.com/maps?q=${selectedSchool.coords}`, "_blank");
        closeModal();
      };
      modalButtons.appendChild(visitBtn);

      if (isPinned) {
        const moveUpBtn = document.createElement("button");
        moveUpBtn.textContent = "↑ Move Up";
        moveUpBtn.className = "move-up-btn";
        moveUpBtn.onclick = () => {
          const prev = selectedSchool.element.previousElementSibling;
          if (prev && prev.classList.contains('school')) {
            pinnedContainer.insertBefore(selectedSchool.element, prev);
            savePinnedSchools();
          }
          closeModal();
        };
        modalButtons.appendChild(moveUpBtn);

        const removeBtn = document.createElement("button");
        removeBtn.textContent = "Remove";
        removeBtn.className = "remove-btn";
        removeBtn.onclick = () => {
          selectedSchool.element.remove();
          savePinnedSchools();
          updateTripCount();
          closeModal();
        };
        modalButtons.appendChild(removeBtn);

        const moveDownBtn = document.createElement("button");
        moveDownBtn.textContent = "↓ Move Down";
        moveDownBtn.className = "move-down-btn";
        moveDownBtn.onclick = () => {
          const next = selectedSchool.element.nextElementSibling;
          const clearBtn = pinnedContainer.querySelector(".reset-button");
          if (next && next !== clearBtn) {
            pinnedContainer.insertBefore(next, selectedSchool.element);
            savePinnedSchools();
          }
          closeModal();
        };
        modalButtons.appendChild(moveDownBtn);

      } else {
        const alreadyPinned = [...pinnedContainer.querySelectorAll('.school')].some(
          s => s.querySelector('.coordenates').textContent === selectedSchool.coords
        );

        if (alreadyPinned) {
          modalMessage.textContent = "ALREADY IN YOUR TRIP";
          modalMessage.classList.add("warning");
        } else {
          const addBtn = document.createElement("button");
          addBtn.textContent = "Add";
          addBtn.className = "add-btn";
          addBtn.onclick = () => {
            addSchoolToPinned(selectedSchool.element);
            closeModal();
          };
          modalButtons.appendChild(addBtn);
        }
      }

      const cancelBtn = document.createElement("button");
      cancelBtn.textContent = "Cancel";
      cancelBtn.className = "cancel-btn";
      cancelBtn.onclick = closeModal;
      modalButtons.appendChild(cancelBtn);

      modal.style.display = "flex";
    }

    function closeModal() {
      modal.style.display = "none";
    }

    function savePinnedSchools() {
      const pinned = [...pinnedContainer.querySelectorAll('.school')];
      const data = pinned.map(s => s.outerHTML);
      localStorage.setItem("pinnedSchools", JSON.stringify(data));
    }

    function updateTripCount() {
      const count = pinnedContainer.querySelectorAll('.school').length;
      tripCount.textContent = "Trip Count: " + count;
    }

    function resetPinnedSchools() {
      pinnedContainer.querySelectorAll('.school').forEach(e => e.remove());
      savePinnedSchools();
      updateTripCount();
    }

    function addSchoolToPinned(schoolElement) {
      const clone = schoolElement.cloneNode(true);
      attachSchoolEvents(clone, true);
      const clearBtn = pinnedContainer.querySelector(".reset-button");
      pinnedContainer.insertBefore(clone, clearBtn);
      savePinnedSchools();
      updateTripCount();
    }

    searchInput.addEventListener("input", () => {
      const query = searchInput.value.toLowerCase();
      const allSchools = document.querySelectorAll(".school");
      const pinnedSchools = document.querySelectorAll("#pinnedSchools .school");
      const schools = [...allSchools].filter(s => ![...pinnedSchools].includes(s));

      const titles = document.querySelectorAll(".section-title");

      schools.forEach(school => {
        const name = school.querySelector(".school-name").textContent.toLowerCase();
        const location = school.querySelector(".school-location").textContent.toLowerCase();
        const address = school.querySelector(".school-address").textContent.toLowerCase();
        
        if (name.includes(query) || location.includes(query) || address.includes(query)) {
          school.classList.remove("hidden");
        } else {
          school.classList.add("hidden");
        }
      });

      titles.forEach(title => {
        let next = title.nextElementSibling;
        let hasVisible = false;
        while (next && next.classList.contains("school")) {
          if (!next.classList.contains("hidden")) {
            hasVisible = true;
            break;
          }
          next = next.nextElementSibling;
        }
        if (hasVisible) {
          title.classList.remove("hidden");
        } else {
          title.classList.add("hidden");
        }
      });
    });
  </script>
</body>
</html>
